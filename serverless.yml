service:
  name: deregister-sub

package:
  individually: true
  exclude:
    - '**/**'

provider:
  name: aws
  runtime: nodejs12.x
  stackName: ${self:service.name}-stack
  stage: ${opt:stage, 'prod'}
  region: eu-central-1
  deploymentBucket:
    name: kaskadi-serverless-deployment-bucket
  stackTags: 
    app: kaskadi
  tags:
    app: kaskadi
    service: ${self:service.name}
    logical-unit: push
    type: eventBridge

functions:
  AutoDeregisterSub:
    handler: deregister-sub.handler
    name: ${self:service.name}
    package:
      include:
        - 'deregister-sub.js'
    events:
      - eventBridge:
          eventBus: ${env:EVENT_BUS_ARN}
          pattern:
            detail:
              responsePayload:
                hasDeadEndpoints:
                  - true
